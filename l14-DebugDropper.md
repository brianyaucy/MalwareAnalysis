# Lab 14 - Debugging a 64-bit Dropper

- [Lab 14 - Debugging a 64-bit Dropper](#lab-14---debugging-a-64-bit-dropper)
  - [Scenario](#scenario)
  - [Tools](#tools)
  - [Task 1: PE and Resource info](#task-1-pe-and-resource-info)
  - [Task 2: Function calls and Breakpoints](#task-2-function-calls-and-breakpoints)
  - [Task 3: Running the Dropper](#task-3-running-the-dropper)
  - [Task 4: Debugging the shellcode](#task-4-debugging-the-shellcode)
  - [Task 5: Explain the Graph Code Blocks](#task-5-explain-the-graph-code-blocks)

---

## Scenario

You’ve been called by a client to examine a sample that was found on one of their developer’s systems. The client thinks this sample could be hiding its true nature of activity.

<br/>

The goal of this lab is to understand how to both debug and reverse engineer a dropper, which is widely used by different threat actors.

<br/>

After completing this lab, you will be able to use a debugger such as x64dbg (and perhaps a disassembler, such as IDA Pro) to debug and reverse engineer a malicious 64-bit Dropper that drops a shellcode from its resource section and executes it. You will learn how to go through the code step-by-step and debug the shellcode to understand its true nature. This also is an excellent lab to learn more about 64-bit assembly and shellcode.

<br/>

192.168.210.10 / AdminELS / Nu3pmkfyX

<br/>

---

## Tools

- x64dbg
- IDA Pro
- PEStudio

<br/>

---

## Task 1: PE and Resource info

**Question**

Gather general information about the sample using different tools (static analysis).

<br/>

**Answer**





<br/>

---

## Task 2: Function calls and Breakpoints

**Question**

This is a malicious sample that was collected, and you need to figure out what functions are being used and where to place a breakpoint to control the process.

<br/>

**Answer**





<br/>

---

## Task 3: Running the Dropper

**Question**

Use a debugger to run the dropper and understand what it’s doing.

<br/>

**Answer**





<br/>

---

## Task 4: Debugging the shellcode

**Question**

Use a debugger to trace through the shellcode step-by-step and understand its true nature.

<br/>

**Answer**





<br/>

---

## Task 5: Explain the Graph Code Blocks

**Question**

Generate a graph for the shellcode and explain its blocks. This is a DIY exercise.

<br/>

**Answer**





<br/>

---