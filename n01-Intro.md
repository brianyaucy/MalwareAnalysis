# 01 - Malware Analysis Introduction

- [01 - Malware Analysis Introduction](#01---malware-analysis-introduction)
  - [Skill Requirements](#skill-requirements)
  - [Malware](#malware)
  - [What is Malware Analysis](#what-is-malware-analysis)
  - [Common Tools Categories](#common-tools-categories)
  - [IOC](#ioc)
  - [Types of Malware](#types-of-malware)
  - [Analysis Techniques](#analysis-techniques)
    - [Static Analysis](#static-analysis)
    - [Dynamic Analysis](#dynamic-analysis)
  - [Malware Samples](#malware-samples)
    - [Free](#free)
    - [Free with registration](#free-with-registration)
    - [Commercial](#commercial)
  - [Acquisition Tools](#acquisition-tools)
    - [Disk Imaging Tools](#disk-imaging-tools)
    - [Memory Acquisition Tools](#memory-acquisition-tools)
    - [Other Tools](#other-tools)

----

## Skill Requirements

1. System architecture and low-level programming language (assembly)
2. OS & how it works
3. High-level programming languages (e.g. C, C++, Python)
4. Networking & Network Protocols
5. General cybersecurity knowledge

---

## Malware

Malware = Malicious software

- Describe any malicious program or code that is harmful to systems

<br/>

Common goals of malware:

1. System disruption
2. Data stealing
3. Unauthorized access
4. Espionage
5. Spamming
6. Utilizing the victim's system (e.g. Botnet / DDoS)
7. Ransom

<br/>

---

## What is Malware Analysis

Malware Analysis is the art of dissecting malicious software with the obejctive of answering 3 main questions:

1. How does it work?
2. How can we detect it?
3. How can we defeat and eliminate that threat it creates?

<br/>

Malware Analysis is important, especially when determining:

1. The nature of the malware and its goals
2. What behavior and damage it causes
3. What indicators coudl help detect the malware on systems or during its network communication
4. What vulnerabilities were exploited on the compromised machine and how the attacker moved laterally in the network
5. Who the threat is attributed to and if the threat actors still have a foothold on the system / network
6. How to respond to and eliminate the threat

<br/>

While **Malware Analysis** is closely related to **Reverse Engineering**, it does not mean you cannot analyze malware without Reverse Engineer. 

RE is the art of dissecting a product to understand its blueprint and how it was made.
- dissect an unknown file format, a cryptographic algorithm
- crack and break a software's protection mechanism
- reverse malware

<br/>



---

## Common Tools Categories

1. File format analyzers
2. System & Network monitoring tools
3. Debuggers / Disassemblers
4. Small gadgets - data converters / decryptors /  editors / registry tools / ...
5. Virtualization tools to create contained environments
6. IDE

<br/>

---

## IOC

After finishing analyzing a malware sample, you can write **signatures** to detect the same or similar samples running on other systems.

We call this an **Indictor of Compromise (IOC)**

---

## Types of Malware

1. Viruses (need intervention to infect & spread)
2. Worm (spread itself without intervention)
3. Scareware
4. Ransomware
5. Botnets
6. Trojan
7. Spyware
8. Rootkit (malware conceals the existence of any malicious code in the system)
9. Keylogger
10. Logic bomb
11. Backdoor / Remtoe Access Tool (RAT)
12. Information stealer
13. Downloader
14. Dropper (an executable which has another malware embedded inside it)
15. Adware

<br/>

---

## Analysis Techniques

1. Static Analysis
2. Dynamic Analysis

A common deliverable for a Malware Anaylsis is a **report**, which is produced after the Static Analysis + Dynamic Analysis on a malware sample.

<br/>

### Static Analysis

It is done by dissecting the malware without executing it. 

Basic approach:
- Understand the malware by analyzing the file, file structure, the functions used by the malware

Advanced approach:
- Disassembled the malware and understand the malware basedon the low-level instructions being used

<br/>

### Dynamic Analysis

It is done by dissecting the malware by executing it and monitoring its behavior.

Basic approach:
- Run the sample in a contained environment with different monitoring tools preinstalled
- Understand what the malware is doing based on the output of the tools

Advanced approach:
- Run the sample using **debugger** and control its logic flow

<br/>

---

## Malware Samples

### Free

1. [theZoo - A Live Malware Repository](https://thezoo.morirt.com/)
2. [theZoo - A Live Malware Repository - Github](https://github.com/ytisf/theZoo)
3. [Malware-Traffic-Analysis.net](https://www.malware-traffic-analysis.net/)
4. [fabrimagic72 / malware-samples](https://github.com/fabrimagic72/malware-samples)
5. [TEKDEFENSE](http://www.tekdefense.com/downloads/malware-samples/)
6. [Awesome Open Source - Malware Samples](https://awesomeopensource.com/project/InQuest/malware-samples)
7. [Contagio](https://contagiodump.blogspot.com/)


### Free with registration

1. [VirusShare](https://virusshare.com/)
2. [MalwareBazaar](https://bazaar.abuse.ch/)
3. [ANY RUN](https://app.any.run/)
4. [Hybrid-Analysis](https://www.hybrid-analysis.com/)


### Commercial

1. [ANY RUN](https://app.any.run/)
2. [Hybrid-Analysis](https://www.hybrid-analysis.com/)
3. [VirusTotal](https://www.virustotal.com/gui/)

<br/>

---

## Acquisition Tools

Tools that could be used for evidence acquisition could be categorized into:

1. Disk imaging tools
2. Memory acquisition tools
3. Other

<br/>

### Disk Imaging Tools

1. [Belkasoft](https://belkasoft.com/x) - Acquire data from drives / mobile / Computer RAM / Cloud
2. [Magnet ACQUIRE](https://www.magnetforensics.com/resources/magnet-acquire/) - Acquire iOS/Andriod devices images, as well as hard drives and removable media
3. [FTK Imager](https://accessdata.com/product-download) - Acquire data from hard/removable drives and computer memory

<br/>

### Memory Acquisition Tools 

Note:
RAM is **volatile** - if the system is shut down / rebooted, information stored in RAM is likely be lost.

1. [DumpIt](https://www.comae.com/dumpit/) - Acquire Windows memory via crashdump or as a raw memory dump, with **Directory Table Base**, **Data structures address** (useful for memory analysis framework like **Rekal** / **Volatility**)
2. [Memdump](https://www.nirsoft.net/utils/nircmd.html) - Read the content of memory based on specific parameters and export the output into a text file. The commands: https://nircmd.nirsoft.net/memdump.html
3. [Belkasoft RAM Capturer](https://belkasoft.com/ram-capturer) - Low footprint memory extractor
4. [Magnet RAM Capturer](https://www.magnetforensics.com/resources/magnet-ram-capture/) - Rapid collection of the physical memory, exporting the captured data in raw formats like `.dmp` / `.raw` / `.bin`


<br/>

### Other Tools

1. [Kroll Artifact Parser and Extractor (KAPE)](https://www.kroll.com/en/services/cyber-risk/incident-response-litigation-support/kroll-artifact-parser-extractor-kape) - Efficient and highly configurable triage program that targets essentially any device or storage location, find forensically useful artifacts and parse them within a few minutes
2. [Raw Copy](https://github.com/jschicht/RawCopy) - Command line tool to copy files off NTFS volumes by low level disk reading
3. [GRR](https://grr-doc.readthedocs.io/en/latest/) - An incident response framework focused on remote live forensics.
4. [OS Query](https://osquery.io/) - Record network connections and process executions; rely on SQL queries to search the system data; Cross platforms support
5. [Velocidex](https://www.velocidex.com/) - Opensource endpoint monitoring, digital forensic and cyber response platform
  
<br/>