# Lab 19 - Manually Unpacking a Malware Using x64dbg

- [Lab 19 - Manually Unpacking a Malware Using x64dbg](#lab-19---manually-unpacking-a-malware-using-x64dbg)
  - [Scenario](#scenario)
  - [Goals](#goals)
  - [Task 1: Main Sample Information](#task-1-main-sample-information)
  - [Task 2: Unpacking sample using x64dbg](#task-2-unpacking-sample-using-x64dbg)
  - [Task 3: Dynamic Analysis](#task-3-dynamic-analysis)
  - [Task 4: Sample IOCs](#task-4-sample-iocs)

---

## Scenario

A client shared a sample with you that was collected from their environment and believes it
is packed in some way. The client asks you to unpack the sample and share basic
information about it.

<br/>

---

## Goals

The goal of this lab is to understand how to use online resources and a debugger (x64dbg)
to unpack a sample that is packed.

<br/>

---

## Task 1: Main Sample Information

Use the static analysis skills you learned to gather as much information you can to help with
further tasks. This should include analyzing the PE file to extract strings, sections, libraries,
and APIs referenced, etc.

<br/>

**Answer**

![picture 94](images/158bade190d2157eb5207ec72dec3396fb1c0a2d19f0a4ee9727ef2b4b61a4fc.png)  

- Hashes:
  - md5,63744F970915477D6200184D673CEC98
  - sha1,7C717099D2BB7C71D8ABEAC54108D93B583F4141
  - sha256,7BCC057934FF7D613455387032667F27C5D922B4250F9E83D06C21DA6BBFA18B
- Windows PE
- GUI
- 32-bit
- Entropy: 7.196 (High)

<br/>

![picture 95](images/72b3188ed87e3c5ad4c6a3fd78202ad91cebc962d67e5d525d61dee9e987383d.png)  

- Compile time: 17 Sept 2015

<br/>

![picture 96](images/8fdf8bce24c942bf779521b0beb72494b9b1415fca29d74b3b388c3bb511f24c.png)  

- Sections:
  - .text
  - .rdata
  - .data
  - .rsrc
  - .reloc

<br/>

![picture 97](images/e3f77d5adff39163bb82b57d41a10da7f94eacd072514dd0f6f2f9409767ae9d.png)  

- Interesting strings:
  - (W) SystemTester.exe
  - (A) Select all
  - (A) WINSPOOL>DRV
  - (A) \\settings.ini

<br/>

![picture 98](images/ba562c5be594da9238b36f577f44fd1a43433598f4345df99114a74f8e8465df.png)  

Suspicious imports:

- GetModuleFileNameA
- GetModuleFileNameW
- WriteConsoleW
- QueryPerformanceCounter
- RaiseException
- EnumChildWindows
- FindNextFileW
- DeleteFileA
- SHBrowseForFolderA
- HeapSetInformation
- GetCurrentProcessId
- GetEnvironmentStringsW
- FreeEnvironmentStringsW
- GetCurrentThreadId
- TerminateProcess
- GetCurrentProcess
- SetLastError

<br/>

![picture 99](images/e5bf76711288cdda2e0ee2e7f8e77d7625731baa734e16cd18b541e44f96125e.png)  

Version:

file-type,executable
date,n/a
language,english United States
code-page,Unicode UTF-16, little endian
CompanyName,WinSoft
InternalName,SystemTester
FileDescription,System Performance Tester
Languages,English
PrivateBuild,1.1.1.1
FileVersion,1.1.1.1
LegalCopyright,Copyright ? 2019. All rights reserved. WinSoft
LegalTrademarks,Copyright ? 2019. All rights reserved. WinSoft
OriginalFilename,SystemTester.exe
ProductName,SystemTester
ProductVersion,1.1.1.1

<br/>

---

## Task 2: Unpacking sample using x64dbg

Use the information collected from task one to further analyze and unpack this sample.

<br/>

**Answer**




<br/>

---

## Task 3: Dynamic Analysis

Run the sample in order to understand what it is doing.

<br/>

**Answer**

Load the sample into `x32dbg`.





<br/>

---

## Task 4: Sample IOCs

What are the IOCs that could be created to find and identify this sample on other systems?

<br/>

**Answer**







<br/>

---