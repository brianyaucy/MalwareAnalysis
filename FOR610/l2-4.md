# Lab 2.4: Function Components, Part 2

- [Lab 2.4: Function Components, Part 2](#lab-24-function-components-part-2)
  - [Objectives](#objectives)
  - [Steps](#steps)
  - [1,2 - Calling address and function of CreateProcessW](#12---calling-address-and-function-of-createprocessw)
  - [3 - From how many locations is that function called](#3---from-how-many-locations-is-that-function-called)
  - [4,5 - Number of arguments and local variables](#45---number-of-arguments-and-local-variables)
  - [6,7 - Which instructions comprise the prologue & epilogue?](#67---which-instructions-comprise-the-prologue--epilogue)
  - [8 - What calling convention does it use?](#8---what-calling-convention-does-it-use)

---

## Objectives

- Continue immersion in assembly language.
- Understand key function components.

<br/>

---

## Steps

1. At what address is the `CALL` to `CreateProcessW`?
2. In what function does the `CALL` to `CreateProcessW` reside?
3. From how many locations is that function called (not CreateProcessW, but the function where it is located)?
4. How many arguments does the function take?
5. How many local variables does it use?
6. Which instructions comprise the prologue?
7. Which instructions comprise the epilogue?
8. What calling convention does it use?

<br/>

---

## 1,2 - Calling address and function of CreateProcessW 

Naviagate to the **Imports tab** and type `CreateProcessW`:

![picture 115](../images/45b55e8c4149466ba55896244ef2e12215177c01ec6ff0db5ae3b181b8f6fdc6.png)  

<br/>

Double click to navigate to the assembly view and hit `X`:

![picture 116](../images/0300ae536a59f44000fcffe8b5a54e4da73f3339acfa2f60005378bd83f7be5e.png)  

- Only 1 reference call at `sub_40611C+4A` (`406166`)
- The function including the call to `CreateProcessW` is `sub_40611C`

<br/>

---

## 3 - From how many locations is that function called

Click the function `sub_40611C` and hit `X`:

![picture 117](../images/a4706315bbdd062a93edf330da2d39caaefd82e2949a00141ff6b5a0fcc4f67d.png)  

- There are 4 locations calling `sub_40611C`

<br/>

---

## 4,5 - Number of arguments and local variables

![picture 118](../images/93aeac48679c82a2a178dc3d40c3b8646945aefafedb0acc9f147faefd890b06.png)  

- Number of local variables (`EBP - `): 2
  - `ProcessInformation`
  - `StartupInfo`
- Number of arguments: 2
  - `lpCommandLine`
  - `arg_14`

<br/>

---

## 6,7 - Which instructions comprise the prologue & epilogue?

![picture 119](../images/f442048e6928c8fb0346a4078d2a8c53da8ab09139528fb1ce48913d7b640b3a.png)  

- Prologue is at `40611C - 406124`

<br/>

![picture 120](../images/c8d34dd3de51309cc57f49fc75379fb5067fe23a6b924b8dec8285b8f08810ea.png)  

- Epilogue is at `40617B - 406181`

<br/>

---

## 8 - What calling convention does it use?

![picture 121](../images/cfade05f366e39f0bf87e3c1885f80596be5cb251c71000bc7507a56698cff55.png)  

- IDA indicates this calling convention is **cdecl**

<br/>

![picture 120](../images/c8d34dd3de51309cc57f49fc75379fb5067fe23a6b924b8dec8285b8f08810ea.png)  

- Another way is to check the `RETN` instruction - the end of function does not have any operands

<br/>

---