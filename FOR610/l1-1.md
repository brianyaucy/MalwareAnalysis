# Ex 1.1 - Static Properties Analysis of brbbot.exe

- [Ex 1.1 - Static Properties Analysis of brbbot.exe](#ex-11---static-properties-analysis-of-brbbotexe)
  - [Objectives](#objectives)
  - [Tasks 1: Strings](#tasks-1-strings)
    - [(REMnux) pestr](#remnux-pestr)
    - [(Windows) PeStudio](#windows-pestudio)
    - [(Windows) BinText](#windows-bintext)
  - [Task 2: Spot anomalous aspects](#task-2-spot-anomalous-aspects)
    - [(REMnux) peframe](#remnux-peframe)
    - [(Windows) PeStudio](#windows-pestudio-1)

---

## Objectives

- Learn how to perform an initial assessment of the suspicious Windows executable file.
- Experiment with tools and techniques for examining static properties of a specimen.

<br/>

---

## Tasks 1: Strings

**Task 1**

Extract ASCII and Unicode strings embedded into brbbot.exe.

<br/>

### (REMnux) pestr

We can use in `pestr` in REMnux:

```
pestr brbbot.exe | less
```

![picture 1](../images/ad3a958550f24b06c1470adb3be9a128b96380a320fe4fb22fa78114f20bec22.png)  

<br/>

### (Windows) PeStudio

We can also inspect the strings using **PeStudio**:

![picture 2](../images/84ef97fac46c45c4baf9c5038d2c1cfe3c7d4794082bfa00c4435e18e8eaa0c1.png)  


### (Windows) BinText

Launch **BinText** and change the filter to include strings >=10 characters:

![picture 3](../images/f418428eaee1f72c61b4b5d602c04cc44c5074e1556c5ab6fbf33f5bd527f561.png)  

<br/>

Then scan the sample:

![picture 4](../images/a220f6c727f2ad7788653737a11df3b2daae8a98ad92b36a28b1149f7677a252.png)  

<br/>

---

## Task 2: Spot anomalous aspects

**Task**

Spot anomalous aspects of brbbot.exe.

<br/>

### (REMnux) peframe

Use `peframe` to examine:

```
peframe brbbot.exe
```

- Result:

```
Short information
------------------------------------------------------------
File Name          brbbot.exe
File Size          75776 byte
Compile Time       2015-02-25 01:12:18
DLL                False
Sections           6
Hash MD5           1c7243c8f3586b799a5f9a2e4200aa92
Hash SHA-1         4db5a8e237937b6d7b435a8506b8584121a7e9e3
Imphash            475b069fec5e5868caeb7d4d89236c89
Detected           Packer, Anti Debug
Directory          Import, Resource, Relocation

Packer matched [1]
------------------------------------------------------------
Packer             Microsoft Visual C++ 8.0 (DLL)

Anti Debug discovered [4]
------------------------------------------------------------
Function           GetLastError
Function           IsDebuggerPresent
Function           TerminateProcess
Function           UnhandledExceptionFilter

Suspicious API discovered [44]
------------------------------------------------------------
Function           CloseHandle
Function           CopyFileA
Function           CreateFileA
Function           CreateFileW
Function           CreateProcessA
Function           CryptEncrypt
Function           DeleteFileA
Function           ExitProcess
Function           FindResourceA
Function           GetCommandLineW
Function           GetComputerNameA
Function           GetCurrentProcess
Function           GetCurrentProcessId
Function           GetFileSize
Function           GetModuleFileNameA
Function           GetModuleFileNameW
Function           GetModuleHandleA
Function           GetModuleHandleW
Function           GetProcAddress
Function           GetStartupInfoW
Function           GetSystemDirectoryA
Function           GetTempFileNameA
Function           GetTempPathA
Function           GetTickCount
Function           HttpQueryInfoA
Function           HttpSendRequestA
Function           InternetCloseHandle
Function           InternetConnectA
Function           InternetOpenA
Function           InternetQueryDataAvailable
Function           InternetReadFile
Function           IsDebuggerPresent
Function           LoadLibraryW
Function           LockResource
Function           ReadFile
Function           RegCloseKey
Function           RegDeleteValueA
Function           RegOpenKeyExA
Function           SetFilePointer
Function           Sleep
Function           TerminateProcess
Function           UnhandledExceptionFilter
Function           WSAStartup
Function           WriteFile

File name discovered [7]
------------------------------------------------------------
Temporary          brbconfig.tmp
Library            ADVAPI32.dll
Library            KERNEL32.dll
Library            USER32.dll
Library            WININET.dll
Library            WS2_32.dll
Library            ntdll.dll
```



<br/>

### (Windows) PeStudio

![picture 5](../images/9d9c38b908a09af76cd449036b52edd14a0080526e262b5e631a711f49105495.png)  

