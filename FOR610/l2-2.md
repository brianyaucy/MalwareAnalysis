# Lab 2.2: HTTP C2 Analysis

- [Lab 2.2: HTTP C2 Analysis](#lab-22-http-c2-analysis)
  - [Objectives](#objectives)
  - [Steps](#steps)
  - [1 - Check APIs associated with HTTP C2 in Imports tab](#1---check-apis-associated-with-http-c2-in-imports-tab)
  - [2 - Identify the address of the CALL to HttpSendRequestA](#2---identify-the-address-of-the-call-to-httpsendrequesta)
  - [3 - Describe the condition that occurs immediately after the CALL to HttpSendRequestA](#3---describe-the-condition-that-occurs-immediately-after-the-call-to-httpsendrequesta)

---

## Objectives

- Learn standard APIs used to perform HTTP command and control (C2).
- Continue immersion in assembly language.

<br/>

---

## Steps

1. Go to the **Imports tab** and observe APIs commonly used to perform HTTP C2, including `InternetOpenA`, `InternetConnectA`, `HttpOpenRequestA`, `HttpSendRequestA`, and `InternetReadFile`.
2. Identify the address of the `CALL` to `HttpSendRequestA`.
3. How would you describe the condition that occurs immediately after the `CALL` to `HttpSendRequestA`? Describe it in a sentence and assign as much meaning as possible.
4. Identify the address of the `CALL` to `InternetOpenA`.
5. How would you describe the condition that occurs immediately after the `CALL` to `InternetOpenA`? Describe it in a sentence and assign as much meaning as possible.
6. In what subroutine do the above two `CALL`s occur?
7. How would you characterize that function's purpose?
8. Rename the function to reflect the function's purpose.

<br/>

---

## 1 - Check APIs associated with HTTP C2 in Imports tab

Navigate to the **Imports tab** and sort by the API names. 

![picture 94](../images/6794dc95615db951aebade19b61d5d5574a59893e80cd15694f8e7dc66e4e4d4.png)  

- These APIs starting with `Internet` and `Http` are commonly used in HTTP C2

<br/>

---

## 2 - Identify the address of the CALL to HttpSendRequestA

Continuing **Step 1**, double click the function `HttpSendRequestA`. Click on the function and type `X`:

![picture 95](../images/ebc3e1b84d8db1eb45350ba201ce85108986ebdf5e47145695e0fc27babe55d0.png)  

- Note both of them has the same address `sub_40684C+334`

<br/>

---

## 3 - Describe the condition that occurs immediately after the CALL to HttpSendRequestA

![picture 96](../images/f65c5bab7477eaf0579dff1d1b9c5979f304cf458df3ab0b1a7752ae0f734c02.png)  

