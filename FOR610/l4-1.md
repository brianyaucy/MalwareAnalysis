# Lab 4.1: Assessing the Nature of the Packed brbbot.exe file

- [Lab 4.1: Assessing the Nature of the Packed brbbot.exe file](#lab-41-assessing-the-nature-of-the-packed-brbbotexe-file)
  - [Objectives](#objectives)
  - [Steps](#steps)
  - [1 - Use PeStudio on brbbot.exe](#1---use-pestudio-on-brbbotexe)
  - [2 - Use pescanner.py to check the entropy of brbbot.exe](#2---use-pescannerpy-to-check-the-entropy-of-brbbotexe)
  - [3 - Use diec to scan brbbot.exe](#3---use-diec-to-scan-brbbotexe)

---

## Objectives

- Become familiar with the nature of packed Windows executables.
- Learn how to determine whether a file is packed and, in some cases, identify the packer.
- Gain familiarity with **Detect It Easy**, **Bytehist**, and other static analysis tools that might assist with the initial examination of a potentially packed PE file.

<br/>

---

## Steps

1. On the Windows REM Workstation, use **PeStudio** to examine the imports, sections, and strings of the `brbbot.exe` file.
2. On REMnux, use `pescanner.py` to measure the entropy of `brbbot.exe`'s sections.
3. Use `diec` on REMnux to scan `brbbot.exe` to identify the likely packer's name.

<br/>

---

## 1 - Use PeStudio on brbbot.exe

Open `brbbot.exe` on **PeStudio**. First inspect the imports:

![picture 356](../images/091b8cd0782c0cde3d0110518796363a72c56da140686f2f830e4ee586f97d14.png)  

- There are only a few number of imports - This is a sign of packed executable

<br/>

Inspect the sections:

![picture 357](../images/c3b04554120461986945fbcaa4eaafea3b4663f10456520cd4ddcd67141821a1.png)  

- The following are signatures of packed executables:
  - Uncommon section names `NPX0` and `UPX1`
  - `NPX0` has a raw size of `0`
  - `UPX1` has a high entropy 7.892

<br/>

Inspect the strings:

![picture 358](../images/e3c82b8ad040894b18a1693f3053304c302b1382e0bb02c5b6d9e76e88ef89ef.png)  

- Hard to tell but in theory, a packed executable has fewer strings as compared to unpacked one.

<br/>

---

## 2 - Use pescanner.py to check the entropy of brbbot.exe

Run:

```
pescanner.py brbbot.exe
```

![picture 359](../images/d6049b55ac5c3ac6ff58ba472489c3109138a2b44ab2735309a9feaab579d0f2.png)  

- `NPX0` has 0/8 entropy
- `UPX1` hs 7.89/8 entropy

<br/>

---

## 3 - Use diec to scan brbbot.exe

Run:

```
diec brbbot.exe
```

![picture 360](../images/bdc56ecbb3ffe9084b631b443afcd031e9e3475c9e9ce81977fd036c0e40672f.png)  

- A possible packer used is `UPX(3.91)`

<br/>

---